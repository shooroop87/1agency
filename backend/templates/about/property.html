{% load static %}
<section id="property" class="reviews-section property-rise">
  <!-- фон с затемнением -->
  <div class="reviews-bg">
    <div class="container">

      <!-- карточка-таблица -->
      <div class="pr-card mt150">
        <div class="pr-head mt50-xs">
          <h3 class="pr-title">Rising property<br>values</h3>
          <p class="pr-lead mt30 mb45">
            Rapid development and consistent demand drive continuous price growth,
            ensuring strong capital appreciation for property owners.
          </p>
        </div>

        <p class="pr-eyebrow mb20">Stable returns on investment</p>

        <div class="pr-row">
          <div class="pr-label">Average<br>occupancy rates</div>
          <div class="pr-value">75–80%</div>
          <p class="pr-note">
            Australia remains the leader (24.78% of the market), followed by China, India, France, and Malaysia.
          </p>
        </div>

        <div class="pr-row">
          <div class="pr-label">Average<br>unit yield</div>
          <div class="pr-value">12–15%</div>
          <p class="pr-note">
            Average Unit Yield: Annual rental yields range between 12–15%, making Bali one of the most profitable investment destinations in Southeast Asia.
          </p>
        </div>
      </div>

      <!-- ГАЛЕРЕЯ НА SWIPER -->
      <div class="pr-gallery-wrap mt100 pb70">
        <div class="swiper pr-swiper">
          <div class="swiper-wrapper">
            {% for i in bali_images %}
              <div class="swiper-slide">
                <img class="pr-thumb" src="{% static 'images/bali/' %}{{ i }}.png" alt="" loading="lazy" decoding="async">
              </div>
            {% endfor %}
          </div>
          <div class="swiper-scrollbar"></div>
        </div>
      </div>

    </div>
  </div>
</section>

<style>
/* секция и фон */
.property-rise .reviews-bg{
  border-radius: 30px;
  display: flex;
  align-items: flex-start;
}

/* карточка */
.pr-card{
  background: var(--color-warm-black);
  border-radius: 25px;
  box-shadow: 0 0 8px rgba(0,0,0,.5);
  backdrop-filter: var(--blur-1);
  color: var(--color-white);
  padding: 40px 40px 40px;
  max-width: 1360px;
  margin: 0 auto 34px;
}
.pr-head{ margin-bottom: 18px; }
.pr-title{
  margin:0 0 10px;
  font: 600 26px/1 var(--title-font-family);
}
.pr-lead{
  margin:0;
  max-width: 399px;
  font: 300 15px/1.2 var(--body-font-family);
}
.pr-eyebrow{
  margin: 14px 0;
  color: var(--color-light-grey);
  font: 600 15px/1.2 var(--title-font-family);
}

/* строки таблицы */
.pr-row{
  display:grid;
  grid-template-columns: 220px 1fr 420px;
  align-items:center;
  gap: 201px;
  padding: 30px 0;
  border-top: 1px solid rgba(255,255,255,.2);
}
.pr-row + .pr-row{ border-bottom: 1px solid rgba(255,255,255,.2); }
.pr-label{
  font: 500 18px/1.2 var(--title-font-family);
}
.pr-value{
  justify-self: start;
  font: 600 40px/1.2 var(--title-font-family);
  background: var(--gradient-accent);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}
.pr-note{
  margin:0;
  font: 300 15px/1.2 var(--body-font-family);
  color: var(--color-white);
  max-width: 378px;
}

/* адаптив для карточки/таблицы */
@media (max-width: 1199.98px){
  .pr-row{ grid-template-columns: 1fr; gap: 20px;}
  .pr-note{ order: 3; }
  .pr-card{padding: 20px 20px 20px;}
  .hero-cover__title{text-align: center;}
  .hero-cover__badge{text-align: center;width: 100%;font-size: 18px;line-height: 120%;}
}

/* ГАЛЕРЕЯ SWIPER */
.pr-gallery-wrap{
  position: relative;
}

.pr-swiper{
  overflow: visible;
}

.pr-swiper .swiper-wrapper{
  gap: 20px;
}

.pr-swiper .swiper-slide{
  width: 210px !important;
  height: 216px;
}

.pr-thumb{
  display:block;
  width: 210px;
  height: 216px;
  object-fit: cover;
  border-radius: 30px;
}

/* Линия-индикатор = scrollbar */
.pr-swiper .swiper-scrollbar {
  position:absolute;
  left:0;
  right:0;
  bottom:0;
  width:100%;
  height:4px;
  background: rgba(255,255,255,0.2);
  border-radius: 4px;
  margin-bottom: -30px;
}

/* Ползунок */
.pr-swiper .swiper-scrollbar-drag {
  background: var(--gradient-accent);
  border-radius: 4px;
}

/* Мобильная версия галереи */
@media (max-width: 575px){
  .pr-swiper{
    overflow: visible;
  }

  .pr-swiper .swiper-wrapper{
    display:flex;
    flex-wrap: nowrap;
    overflow-x: scroll;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
  }

  .pr-swiper .swiper-slide{
    scroll-snap-align: start;
    flex-shrink: 0;
  }

  .pr-swiper .swiper-scrollbar{
    display:none; /* на мобиле без линии */
  }
}
</style>

<script>
let propertySwiper;

function initPropertySwiper() {
  // ждём, пока Swiper загрузится
  if (typeof Swiper === 'undefined') {
    console.warn('Swiper for property gallery not loaded yet, retrying...');
    setTimeout(initPropertySwiper, 100);
    return;
  }

  const galleryEl = document.querySelector('.pr-swiper');
  if (!galleryEl) return;

  if (window.innerWidth > 575) {
    if (!propertySwiper) {
      propertySwiper = new Swiper('.pr-swiper', {
        slidesPerView: 'auto',
        spaceBetween: 20,
        freeMode: true,
        grabCursor: true,
        scrollbar: {
          el: '.pr-swiper .swiper-scrollbar',
          draggable: true,
          dragSize: 210, // примерно ширина одного слайда
        }
      });
    }
  } else {
    // на мобиле – обычный горизонтальный скролл
    if (propertySwiper) {
      propertySwiper.destroy(true, true);
      propertySwiper = null;
    }
  }
}

// инициализация
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initPropertySwiper);
} else {
  initPropertySwiper();
}

window.addEventListener('resize', initPropertySwiper);
</script>

{% load static %}
<section class="reviews-section">
  <!-- фон с затемнением -->
  <div class="reviews-bg" style="
    background-image:
      linear-gradient(0deg, rgba(39,39,39,.40), rgba(39,39,39,.40)),
      url('{% static 'images/bg_reviews.png' %}');">
    <div class="container">

      <!-- заголовки + кнопка -->
      <div class="row align-items-center mb30">
        <div class="col-lg-12">
          <p class="reviews-kicker mb25">Reviews about One Agency</p>
          <h2 class="title mb30">What our clients say</h2>
          <a href="#" class="wdt-button button-cta is-nm mb50">
            Leave a review
            <span class="wdt-button__icon" aria-hidden="true"></span>
          </a>
        </div>
      </div>

      <!-- СЛАЙДЕР — названия классов не меняем, только grid на 4 -->
      <div class="testimonial-slider navi_pagi_bottom_center slider-4-grid owl-carousel owl-theme wow fadeInUp" data-wow-delay="300ms">

        <!-- item 1 -->
        <div class="item">
          <article class="review-card">
            <div class="review-card__inner">
              <div class="review-card__head">
                <span class="review-card__name">Name</span>
              </div>
              <div class="review-card__body">
                <h5 class="review-card__title">They treated me very attentively…</h5>
                <p class="review-card__text">
                  I came across the agency purely by chance. They treated me very attentively, offered several property options according to my request, and organized an online meeting with the developer's representatives. They defended my interests when the developer started to push back…
                </p>
              </div>
              <a href="#" class="review-card__more open-review-modal"
                 data-review-name="Name"
                 data-review-title="They treated me very attentively…"
                 data-review-text="I came across the agency purely by chance. They treated me very attentively, offered several property options according to my request, and organized an online meeting with the developer's representatives. They defended my interests when the developer started to push back… Now I'm already making additional payments for my property, and I hope everything will continue to go very well :) I recommend this agency for cooperation!">
                <i class="review-card__more-icon" aria-hidden="true"></i>
                Read more
              </a>
            </div>
          </article>
        </div>

        <!-- item 2 -->
        <div class="item">
          <article class="review-card">
            <div class="review-card__inner">
              <div class="review-card__head"><span class="review-card__name">Name</span></div>
              <div class="review-card__body">
                <h5 class="review-card__title">I felt professional support at every stage…</h5>
                <p class="review-card__text">
                  I am very pleased with the work. Manager Pavel supported the transaction from start to finish, always responded quickly and advised on the best course of action. Everything went smoothly and without any unnecessary hassle…
                </p>
              </div>
              <a href="#" class="review-card__more open-review-modal"
                 data-review-name="Name"
                 data-review-title="I felt professional support at every stage…"
                 data-review-text="I am very pleased with the work. Manager Pavel supported the transaction from start to finish, always responded quickly and advised on the best course of action. Everything went smoothly and without any unnecessary hassle. I felt professional support at every stage and would definitely recommend this agency to my friends.">
                <i class="review-card__more-icon"></i> Read more
              </a>
            </div>
          </article>
        </div>

        <!-- item 3 -->
        <div class="item">
          <article class="review-card">
            <div class="review-card__inner">
              <div class="review-card__head"><span class="review-card__name">Name</span></div>
              <div class="review-card__body">
                <h5 class="review-card__title">It was clear that the team really knows the market…</h5>
                <p class="review-card__text">
                  I turned to one agency on the recommendation of friends, and I don't regret it. From the very beginning, the manager was always in touch, helped with the documents and explained the points I didn't understand…
                </p>
              </div>
              <a href="#" class="review-card__more open-review-modal"
                 data-review-name="Name"
                 data-review-title="It was clear that the team really knows the market…"
                 data-review-text="I turned to one agency on the recommendation of friends, and I don't regret it. From the very beginning, the manager was always in touch, helped with the documents and explained the points I didn't understand. It was clear that the team really knows the market and works honestly. The whole process went quickly and comfortably. Thank you for your professionalism!">
                <i class="review-card__more-icon"></i> Read more
              </a>
            </div>
          </article>
        </div>

        <!-- item 4 -->
        <div class="item">
          <article class="review-card">
            <div class="review-card__inner">
              <div class="review-card__head"><span class="review-card__name">Name</span></div>
              <div class="review-card__body">
                <h5 class="review-card__title">One Agency fully lived up to my expectations…</h5>
                <p class="review-card__text">
                  I came across the agency purely by chance. They treated me very attentively, offered several property options according to my request, organized an online meeting with the developer's representatives…
                </p>
              </div>
              <a href="#" class="review-card__more open-review-modal"
                 data-review-name="Name"
                 data-review-title="One Agency fully lived up to my expectations…"
                 data-review-text="I came across the agency purely by chance. They treated me very attentively, offered several property options according to my request, organized an online meeting with the developer's representatives. One Agency fully lived up to my expectations and helped me find the perfect property. The service was top-notch from start to finish.">
                <i class="review-card__more-icon"></i> Read more
              </a>
            </div>
          </article>
        </div>

      </div>

    </div>
  </div>
</section>

<!-- Review Modal -->
<div id="reviewModal" class="review-modal">
  <div class="review-modal__overlay"></div>
  <div class="review-modal__content">
    <button class="review-modal__close">
      <svg width="21" height="21" viewBox="0 0 21 21" fill="none">
        <path d="M5.5 5.5L15.5 15.5M15.5 5.5L5.5 15.5" stroke="white" stroke-width="1"/>
      </svg>
    </button>

    <div class="review-modal__header">
      <span class="review-modal__name"></span>
      <h3 class="review-modal__title"></h3>
    </div>

    <div class="review-modal__separator"></div>

    <div class="review-modal__text"></div>
  </div>
</div>

<style>
/* Review Modal */
.review-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 9997;
  display: none;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.review-modal.is-active {
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 1;
}

.review-modal__overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.85);
  backdrop-filter: blur(8px);
}

.review-modal__content {
  position: relative;
  width: 850px;
  max-width: 95%;
  max-height: 90vh;
  background: #272727;
  border-radius: 30px;
  padding: 60px 50px 50px;
  z-index: 1;
  overflow-y: auto;
}

.review-modal__close {
  position: absolute;
  top: 25px;
  right: 25px;
  width: 21px;
  height: 21px;
  background: transparent;
  border: none;
  cursor: pointer;
  z-index: 10;
  padding: 0;
  transition: transform 0.2s;
}

.review-modal__close:hover {
  transform: rotate(90deg);
}

.review-modal__header {
  display: grid;
  grid-template-columns: 100px 1fr;
  gap: 40px;
  margin-bottom: 30px;
}

.review-modal__name {
  font-family: 'Manrope', sans-serif;
  font-weight: 400;
  font-size: 16px;
  line-height: 1.5;
  color: rgba(255, 255, 255, 0.6);
}

.review-modal__title {
  font-family: 'Manrope', sans-serif;
  font-weight: 600;
  font-size: 20px;
  line-height: 1.3;
  color: #FFFFFF;
  margin: 0;
}

.review-modal__separator {
  width: 100%;
  height: 1px;
  background: rgba(255, 255, 255, 0.2);
  margin-bottom: 30px;
}

.review-modal__text {
  font-family: 'Manrope', sans-serif;
  font-weight: 400;
  font-size: 16px;
  line-height: 1.6;
  color: #FFFFFF;
  white-space: pre-line;
}

/* Custom Scrollbar для review modal */
.review-modal__content::-webkit-scrollbar {
  width: 8px;
}

.review-modal__content::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 0 30px 30px 0;
}

.review-modal__content::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, #F0987D 0%, #CE7F63 50%, #EA9278 100%);
  border-radius: 10px;
}

.review-modal__content::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, #FFBEA4 0%, #F0987D 50%, #D7785B 100%);
}

/* Firefox */
.review-modal__content {
  scrollbar-width: thin;
  scrollbar-color: #E08A72 rgba(0, 0, 0, 0.2);
}

/* Mobile */
@media (max-width: 767px) {
  .review-modal__content {
    width: 100%;
    max-width: 100%;
    max-height: 100vh;
    border-radius: 20px;
    padding: 50px 25px 30px;
  }

  .review-modal__header {
    grid-template-columns: 1fr;
    gap: 15px;
  }

  .review-modal__title {
    font-size: 18px;
  }

  .review-modal__text {
    font-size: 14px;
  }
}
</style>

<script>
// Review Modal
document.addEventListener('DOMContentLoaded', function() {
  const reviewModal = document.getElementById('reviewModal');
  
  if (!reviewModal) return;
  
  const openReviewBtns = document.querySelectorAll('.open-review-modal');
  const closeReviewBtn = reviewModal.querySelector('.review-modal__close');
  const reviewOverlay = reviewModal.querySelector('.review-modal__overlay');
  const reviewName = reviewModal.querySelector('.review-modal__name');
  const reviewTitle = reviewModal.querySelector('.review-modal__title');
  const reviewText = reviewModal.querySelector('.review-modal__text');

  // Открытие модалки отзыва
  openReviewBtns.forEach(btn => {
    btn.addEventListener('click', function(e) {
      e.preventDefault();
      
      const name = this.getAttribute('data-review-name');
      const title = this.getAttribute('data-review-title');
      const text = this.getAttribute('data-review-text');

      // Заполняем данные
      reviewName.textContent = name;
      reviewTitle.textContent = title;
      reviewText.textContent = text;

      // Открываем модалку
      reviewModal.classList.add('is-active');
      document.body.style.overflow = 'hidden';
    });
  });

  // Закрытие модалки отзыва
  function closeReviewModal() {
    reviewModal.classList.remove('is-active');
    document.body.style.overflow = '';
  }

  if (closeReviewBtn) {
    closeReviewBtn.addEventListener('click', closeReviewModal);
  }
  
  if (reviewOverlay) {
    reviewOverlay.addEventListener('click', closeReviewModal);
  }

  // Закрытие по ESC
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && reviewModal.classList.contains('is-active')) {
      closeReviewModal();
    }
  });
});
</script>
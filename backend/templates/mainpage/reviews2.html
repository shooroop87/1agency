{% load static %}
<section class="reviews-section">
  <!-- фон с затемнением -->
  <div class="reviews-bg" style="
    background-image:
      linear-gradient(0deg, rgba(39,39,39,.40), rgba(39,39,39,.40)),
      url('{% static 'images/bg_reviews.png' %}');">
    <div class="container">

      <!-- заголовки + кнопка -->
      <div class="row align-items-center mb30 mb10-xs pt150 pt80-xs">
        <div class="col-lg-12">
          <p class="reviews-kicker mb25">Reviews about One Agency</p>
          <h2 class="title mb30">What our clients say</h2>
          <a href="#" class="wdt-button button-cta3 is-nm mb50">
            Leave a review
            <span class="wdt-button__icon" aria-hidden="true"></span>
          </a>
        </div>
      </div>

      <!-- СЛАЙДЕР — названия классов не меняем, только grid на 4 -->
      <div class="testimonial-slider navi_pagi_bottom_center slider-4-grid owl-carousel owl-theme wow fadeInUp" data-wow-delay="300ms">

<!-- item 1 -->
<div class="item">
  <article class="review-card">
    <div class="review-card__inner">
      <div class="review-card__head">
        <span class="review-card__name">Client</span>
      </div>
      <div class="review-card__body">
        <h5 class="review-card__title">They treated me very attentively…</h5>
        <p class="review-card__text">
          I came across the agency purely by chance. They treated me very attentively, offered several property options according to my request, and organized an online meeting with the developer's representatives…
        </p>
      </div>
      <a href="#" class="review-card__more open-review-modal"
         data-review-name="Client"
         data-review-title="They treated me very attentively…"
         data-review-text="I came across the agency purely by chance. They treated me very attentively, offered several property options according to my request, and organized an online meeting with the developer's representatives. They defended my interests when the developer started to push back… Now I'm already making additional payments for my property, and I hope everything will continue to go very well :) I recommend this agency for cooperation!">
        <i class="review-card__more-icon" aria-hidden="true"></i>
        Read more
      </a>
    </div>
  </article>
</div>

<!-- item 2 -->
<div class="item">
  <article class="review-card">
    <div class="review-card__inner">
      <div class="review-card__head"><span class="review-card__name">Client</span></div>
      <div class="review-card__body">
        <h5 class="review-card__title">I felt professional support at every stage…</h5>
        <p class="review-card__text">
          I am very pleased with the work. Manager Pavel supported the transaction from start to finish, he always responded quickly and advised on the best course of action…
        </p>
      </div>
      <a href="#" class="review-card__more open-review-modal"
         data-review-name="Client"
         data-review-title="I felt professional support at every stage…"
         data-review-text="I am very pleased with the work. Manager Pavel supported the transaction from start to finish, he always responded quickly and advised on the best course of action. Everything went smoothly and without any unnecessary hassle. I felt professional support at every stage. Thank you for the excellent work!">
        <i class="review-card__more-icon"></i> Read more
      </a>
    </div>
  </article>
</div>

<!-- item 3 -->
<div class="item">
  <article class="review-card">
    <div class="review-card__inner">
      <div class="review-card__head"><span class="review-card__name">Client</span></div>
      <div class="review-card__body">
        <h5 class="review-card__title">The team really knows the market…</h5>
        <p class="review-card__text">
          I turned to one agency on the recommendation of friends, and I don't regret it. From the very beginning, manager Dina handled the deal, she was always in touch…
        </p>
      </div>
      <a href="#" class="review-card__more open-review-modal"
         data-review-name="Client"
         data-review-title="The team really knows the market…"
         data-review-text="I turned to one agency on the recommendation of friends, and I don't regret it. From the very beginning, manager Dina handled the deal, she was always in touch, helped with the documents, and explained the points I didn't understand. Everything went smoothly, without delays or unpleasant surprises. It was clear that the team really knows the market and works in the client's best interests. I'm satisfied and will definitely recommend them.">
        <i class="review-card__more-icon"></i> Read more
      </a>
    </div>
  </article>
</div>

<!-- item 4 -->
<div class="item">
  <article class="review-card">
    <div class="review-card__inner">
      <div class="review-card__head"><span class="review-card__name">Client</span></div>
      <div class="review-card__body">
        <h5 class="review-card__title">One Agency fully lived up to my expectations…</h5>
        <p class="review-card__text">
          I would like to thank the One Agency team for their outstanding work. Buying property abroad is always associated with stress and many questions…
        </p>
      </div>
      <a href="#" class="review-card__more open-review-modal"
         data-review-name="Client"
         data-review-title="One Agency fully lived up to my expectations…"
         data-review-text="I would like to thank the One Agency team for their outstanding work. Buying property abroad is always associated with stress and many questions, but with their support the process turned out to be much easier than I expected. Special thanks to the manager, he guided the deal from the very first call to the signing of the contract. He was always quick to respond, explained every step in detail, and helped me understand the legal aspects. It was clear that he was genuinely interested in making the transaction as convenient and safe for me as possible. All the documents were thoroughly checked, and there were no hidden conditions or unexpected issues. What I especially appreciated was that the team handled communication with the developer and lawyers, which saved me a lot of time and energy. In the end, I got exactly the result I was hoping for, and I can say with confidence that One Agency fully lived up to my expectations. This is a professional and reliable team that I can wholeheartedly recommend to anyone considering buying property in Bali.">
        <i class="review-card__more-icon"></i> Read more
      </a>
    </div>
  </article>
</div>

<!-- item 5 -->
<div class="item">
  <article class="review-card">
    <div class="review-card__inner">
      <div class="review-card__head"><span class="review-card__name">Client</span></div>
      <div class="review-card__body">
        <h5 class="review-card__title">I felt supported at every stage…</h5>
        <p class="review-card__text">
          I purchased property in Bali through One Agency and was very satisfied. At first, I had many doubts and questions, but the agency explained everything in detail…
        </p>
      </div>
      <a href="#" class="review-card__more open-review-modal"
         data-review-name="Client"
         data-review-title="I felt supported at every stage…"
         data-review-text="I purchased property in Bali through One Agency and was very satisfied. At first, I had many doubts and questions, but the agency explained everything in detail, showed me different options, and helped me understand all the specifics. At every stage, I felt supported and that my interests were taken into account. The transaction went smoothly and without any problems — everything was transparent and clear. It was a pleasure to work with people who truly know the market and don't try to push anything unnecessary.">
        <i class="review-card__more-icon"></i> Read more
      </a>
    </div>
  </article>
</div>

      </div>

    </div>
  </div>
</section>

<!-- Leave Review Modal -->
<div id="leaveReviewModal" class="question-modal">
  <div class="question-modal__overlay"></div>
  <div class="question-modal__content">
    <button class="question-modal__close">
      <svg width="21" height="21" viewBox="0 0 21 21" fill="none">
        <path d="M5.5 5.5L15.5 15.5M15.5 5.5L5.5 15.5" stroke="white" stroke-width="1"/>
      </svg>
    </button>

    <div id="leaveReviewBody">
      <div class="question-modal__header">
        <h3 class="question-modal__title">Leave a review</h3>
      </div>

      <form id="leaveReviewForm" class="question-form">
        <div class="question-form__field">
          <input type="text" name="name" placeholder="Your name" required>
        </div>
        <div class="question-form__field">
          <input type="email" name="email" placeholder="Email" required>
        </div>
        <div class="question-form__field">
          <textarea name="review" placeholder="Your review..." required></textarea>
        </div>
        <div class="question-form__checkbox">
          <label>
            <input type="checkbox" name="privacy" required>
            <span class="checkbox-custom"></span>
            <span>I agree to the processing of personal data</span>
          </label>
        </div>
        <button type="submit" class="question-form__submit">
          Submit review
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M3 8H13M13 8L8 3M13 8L8 13" stroke="white" stroke-width="1.5"/>
          </svg>
        </button>
      </form>
    </div>

    <div id="leaveReviewSuccess" class="question-modal__success">
      <div class="question-modal__success-inner">
        <h4 class="question-modal__success-title">Thank you!</h4>
        <p class="question-modal__success-text">Your review has been submitted</p>
        <button class="question-modal__success-btn close-leave-review">
          Close
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M3 8H13M13 8L8 3M13 8L8 13" stroke="white" stroke-width="1.5"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>

<style>
/* Review Modal */
.review-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 9997;
  display: none;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.review-modal.is-active {
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 1;
}

.review-modal__overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.85);
  backdrop-filter: blur(8px);
}

.review-modal__content {
  position: relative;
  width: 850px;
  max-width: 95%;
  max-height: 90vh;
  background: #272727;
  border-radius: 30px;
  padding: 60px 50px 50px;
  z-index: 1;
  overflow-y: auto;
}

.review-modal__close {
  position: absolute;
  top: 25px;
  right: 25px;
  width: 21px;
  height: 21px;
  background: transparent;
  border: none;
  cursor: pointer;
  z-index: 10;
  padding: 0;
  transition: transform 0.2s;
}

.review-modal__close:hover {
  transform: rotate(90deg);
}

.review-modal__header {
  display: grid;
  grid-template-columns: 100px 1fr;
  gap: 40px;
  margin-bottom: 30px;
}

.review-modal__name {
  font-family: 'Manrope', sans-serif;
  font-weight: 400;
  font-size: 16px;
  line-height: 1.5;
  color: rgba(255, 255, 255, 0.6);
}

.review-modal__title {
  font-family: 'Manrope', sans-serif;
  font-weight: 600;
  font-size: 20px;
  line-height: 1.3;
  color: #FFFFFF;
  margin: 0;
}

.review-modal__separator {
  width: 100%;
  height: 1px;
  background: rgba(255, 255, 255, 0.2);
  margin-bottom: 30px;
}

.review-modal__text {
  font-family: 'Manrope', sans-serif;
  font-weight: 400;
  font-size: 16px;
  line-height: 1.6;
  color: #FFFFFF;
  white-space: pre-line;
}

/* Custom Scrollbar для review modal */
.review-modal__content::-webkit-scrollbar {
  width: 8px;
}

.review-modal__content::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 0 30px 30px 0;
}

.review-modal__content::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, #F0987D 0%, #CE7F63 50%, #EA9278 100%);
  border-radius: 10px;
}

.review-modal__content::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, #FFBEA4 0%, #F0987D 50%, #D7785B 100%);
}

/* Firefox */
.review-modal__content {
  scrollbar-width: thin;
  scrollbar-color: #E08A72 rgba(0, 0, 0, 0.2);
}

/* Mobile */
@media (max-width: 767px) {
  .review-modal__content {
    width: 100%;
    max-width: 100%;
    max-height: 100vh;
    border-radius: 20px;
    padding: 50px 25px 30px;
  }

  .review-modal__header {
    grid-template-columns: 1fr;
    gap: 15px;
  }

  .review-modal__title {
    font-size: 18px;
  }

  .review-modal__text {
    font-size: 14px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const leaveModal = document.getElementById('leaveReviewModal');
  if (!leaveModal) return;

  const openBtn = document.querySelector('.reviews-section .wdt-button.button-cta3');
  const closeBtn = leaveModal.querySelector('.question-modal__close');
  const overlay = leaveModal.querySelector('.question-modal__overlay');
  const form = document.getElementById('leaveReviewForm');
  const body = document.getElementById('leaveReviewBody');
  const success = document.getElementById('leaveReviewSuccess');
  const successCloseBtn = leaveModal.querySelector('.close-leave-review');

  function reset() {
    if (form) form.reset();
    if (body) body.style.display = 'block';
    if (success) success.style.display = 'none';
  }

  function open(e) {
    if (e) e.preventDefault();
    reset();
    leaveModal.classList.add('is-active');
    document.body.style.overflow = 'hidden';
  }

  function close() {
    leaveModal.classList.remove('is-active');
    document.body.style.overflow = '';
  }

  if (openBtn) openBtn.addEventListener('click', open);
  if (closeBtn) closeBtn.addEventListener('click', close);
  if (overlay) overlay.addEventListener('click', close);
  if (successCloseBtn) successCloseBtn.addEventListener('click', close);

  document.addEventListener('keydown', e => {
    if (e.key === 'Escape' && leaveModal.classList.contains('is-active')) close();
  });

  if (form) {
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      // TODO: отправка на сервер
      console.log('Review submitted:', Object.fromEntries(new FormData(form)));
      if (body) body.style.display = 'none';
      if (success) success.style.display = 'block';
    });
  }
});
</script>